/*!
 * cxValidation
 * 
 * @version 1.1.0
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxValidation
 * @license Released under the MIT license
 */
!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.cxValidation=b()}("undefined"!=typeof self?self:this,function(){"use strict";var b,a={validMessage:{titleSymbol:{before:"【",after:"】"},required:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},groupRequired:{input:"至少填写 {{1}} 项",radio:"未选择",checkbox:"至少选择 {{1}} 项"},condRequired:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},equals:"两次输入内容不一致",minSize:"最少 {{0}} 个字符",maxSize:"最多 {{0}} 个字符",min:"最小值为 {{0}}",max:"最大值为 {{0}}",integer:"无效的整数",number:"无效的数值",onlyNumber:"只能填写数字",onlyNumberSp:"只能填写数字和空格",onlyLetter:"只能填写英文字母",onlyLetterSp:"只能填写英文字母和空格",onlyLetterNumber:"只能填写英文字母与数字",onlyLetterNumberSp:"只能填写英文字母、数字、空格",email:"无效的邮件地址",phone:"无效的电话号码",url:"无效的网址",chinese:"只能填写中文汉字",chinaId:"无效的身份证号码",chinaIdLoose:"无效的身份证号码",chinaZip:"无效的邮政编码",qq:"无效的 QQ 号码"},result:{status:!0},vid:1,formFuns:{},groupCache:{},isElement:function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},isHidden:function(a){if(this.isElement(a)){var b=window.getComputedStyle(a);return"none"===b.getPropertyValue("display")||"hidden"===b.getPropertyValue("visibility")||0==b.getPropertyValue("opacity")||0==b.getPropertyValue("width")&&0==b.getPropertyValue("height")?!0:!1}return!0},isVisible:function(a){return!this.isHidden(a)}};return a.init=function(){var a=this;a.defaults={success:function(a){a.form.submit()},error:function(b){var c=b.element.nodeName.toLowerCase();"required"===b.rule||"condRequired"===b.rule?"input"===c&&["radio","checkbox","color","range","file","hidden"].indexOf(b.element.type)>=0?a.toMessage(b.message):a.toFocus(b.element):a.toMessage(b.message)}}},a.validFun={required:function(a){return"checkbox"===a.type||"radio"===a.type?a.checked?!0:!1:a.value.trim().length?!0:!1},groupRequired:function(a,b,c){var d=this;return b=String(b),c=parseInt(c,10),isNaN(c)&&(c=1),("undefined"==typeof d.groupCache[b]||"undefined"==typeof d.groupCache[b].count)&&(d.groupCache[b]={count:c}),d.groupCache[b].count>0&&(d.validFun.required(a)?d.groupCache[b].count-=1:"undefined"==typeof d.groupCache[b].element&&(d.groupCache[b].element=a)),!0},condRequired:function(a,b,c){var g,h,d=this,e=!1,f=!0;if("string"==typeof b&&b.length){if(b.indexOf(",")>0){if(b=b.split(","),Array.isArray(b)&&b.length)for(e=!0,g=0,h=b.length;h>g;g++)if(!d.validFun.required(document.getElementById(b[g]))){e=!1;break}}else"string"==typeof c?document.getElementById(b).value===c&&(e=!0):d.validFun.required(document.getElementById(b))&&(e=!0);e&&(f=d.validFun.required(a))}return f},equals:function(a,b){return a.value==document.getElementById(b).value},minSize:function(a,b){return a.value.length?a.value.length>=b:!0},maxSize:function(a,b){return a.value.length?a.value.length<=b:!0},min:function(a,b){return a.value.length?parseFloat(a.value)>=b:!0},max:function(a,b){return a.value.length?parseFloat(a.value)<=b:!0},integer:function(a){return a.value.length?/^[\-\+]?\d+$/.test(a.value):!0},number:function(a){return a.value.length?/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/.test(a.value):!0},onlyNumber:function(a){return a.value.length?/^[0-9]+$/.test(a.value):!0},onlyNumberSp:function(a){return a.value.length?/^[0-9\ ]+$/.test(a.value):!0},onlyLetter:function(a){return a.value.length?/^[a-zA-Z]+$/.test(a.value):!0},onlyLetterSp:function(a){return a.value.length?/^[a-zA-Z\ ]+$/.test(a.value):!0},onlyLetterNumber:function(a){return a.value.length?/^[0-9a-zA-Z]+$/.test(a.value):!0},onlyLetterNumberSp:function(a){return a.value.length?/^[0-9a-zA-Z\ ]+$/.test(a.value):!0},email:function(a){return a.value.length?/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a.value):!0},phone:function(a){return a.value.length?/^([\+][0-9]{1,3}[ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/.test(a.value):!0},url:function(a){return a.value.length?/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a.value):!0},chinese:function(a){return a.value.length?/^[\u4E00-\u9FA5]+$/.test(a.value):!0},chinaId:function(a){return a.value.length?/^[1-9]\d{5}[1-9]\d{3}(((0[13578]|1[02])(0[1-9]|[12]\d|3[0-1]))|((0[469]|11)(0[1-9]|[12]\d|30))|(02(0[1-9]|[12]\d)))(\d{4}|\d{3}[xX])$/.test(a.value):!0},chinaIdLoose:function(a){return a.value.length?/^(\d{18}|\d{15}|\d{17}[xX])$/.test(a.value):!0},chinaZip:function(a){return a.value.length?/^\d{6}$/.test(a.value):!0},qq:function(a){return a.value.length?/^[1-9]\d{4,10}$/.test(a.value):!0},call:function(){var a=Array.prototype.slice.call(arguments),b=a.splice(1,1),c=window;if(b.indexOf(".")>=0)for(b=b.split(".");b.length;)c=c[b.shift()];else c=c[b];return"function"==typeof c?c.apply(c,a):!0}},a.getRuleArguments=function(a,b){var e,c=a.dataset.validation,d=[],f=[];return"string"==typeof c&&c.length&&(d=c.replace(/\s|\[[^\]]*\]/g,"").split(",")),"string"==typeof b&&b.length&&d.indexOf(b)>=0&&(e=c.match(new RegExp(b+"((\\[[^\\]]+\\])+)")),Array.isArray(e)&&e.length>1&&(f=e[1].match(/([^\[\]]+)/g),Array.isArray(f)&&1===f.length&&"groupRequired"===b&&(f[1]=1))),f},a.getMessage=function(a,b){var f,h,i,c=this,d=a.nodeName.toLowerCase(),e="";if("string"==typeof a.dataset.validationMessage&&a.dataset.validationMessage.length)try{e=JSON.parse(a.dataset.validationMessage),"string"==typeof e[b]&&e[b].length&&(e=e[b])}catch(g){e=a.dataset.validationMessage}else("string"==typeof c.validMessage[b]||"object"==typeof c.validMessage[b])&&("string"==typeof c.validMessage[b]?e=c.validMessage[b]:"input"===d?"radio"===a.type&&"string"==typeof c.validMessage[b].radio?e=c.validMessage[b].radio:"checkbox"===a.type&&"string"==typeof c.validMessage[b].checkbox?e=c.validMessage[b].checkbox:"string"==typeof c.validMessage[b].input&&(e=c.validMessage[b].input):"select"===d&&"string"==typeof c.validMessage[b].select?e=c.validMessage[b].select:"string"==typeof c.validMessage[b].input&&(e=c.validMessage[b].input),e.length&&"string"==typeof a.dataset.validationTitle&&a.dataset.validationTitle.length&&(e=c.validMessage.titleSymbol.before+a.dataset.validationTitle+c.validMessage.titleSymbol.after+e));if(e.length)for(f=c.getRuleArguments(a,b),h=0,i=f.length;i>h;h++)e=e.replace(new RegExp("\\{\\{"+h+"\\}\\}"),f[h]);return e},a.validItem=function(a,b){var g,h,i,j,k,c=this,d=Object.assign({},c.result),e=a.dataset.validation,f=[];if(b=Object.assign({},b),"string"==typeof e&&e.length)for(f=e.replace(/\s|\[[^\]]*\]/g,"").split(","),j=0,k=f.length;k>j;j++)if(i=f[j],"function"==typeof c.validFun[i]&&(g=e.match(new RegExp(i+"((\\[[^\\]]+\\])+)")),h=[a],Array.isArray(g)&&g.length>1&&(h=h.concat(g[1].match(/([^\[\]]+)/g))),d=c.validFun[i].apply(c,h),"boolean"==typeof d&&(d={status:d}),"object"==typeof d&&"boolean"==typeof d.status&&d.status===!1)){d.rule=i,"string"==typeof d.message&&d.message.length||(d.message=c.getMessage(a,i));break}return d.element=a,"function"==typeof b.complete&&b.complete(d),d.status===!0&&"function"==typeof b.success?b.success(d):d.status===!1&&"function"==typeof b.error&&b.error(d),d},a.validForm=function(a,b){var e,f,g,h,i,c=this,d=Object.assign({},c.result);for(b=Object.assign({},b),e=a.querySelectorAll("input,textarea,select"),c.groupCache={},f=0,g=e.length;g>f;f++)if(h=c.validItem(e[f]),h&&h.status===!1){d.status=!1,d.element=e[f],"string"==typeof h.rule&&h.rule.length&&(d.rule=h.rule),"string"==typeof h.message&&h.message.length&&(d.message=h.message);break}if(d&&d.status===!0)for(i in c.groupCache)if(c.groupCache[i].count>0){d.status=!1,d.rule="groupRequired",d.element=c.groupCache[i].element,d.message=c.getMessage(d.element,d.rule);break}return d.form=a,c.groupCache={},"function"==typeof b.complete&&b.complete(d),d.status===!0&&"function"==typeof b.success?b.success(d):d.status===!1&&"function"==typeof b.error&&b.error(d),d},a.formSubmitFn=function(a,b){event.preventDefault(),this.validForm(a,Object.assign({},this.defaults,b))},a.toMessage=function(a){alert(a)},a.toFocus=function(a){this.isVisible(a)&&a.focus()},a.init(),b=function(){return b.valid.apply(b,arguments)},b.setOptions=function(b){Object.assign(a.defaults,b)},b.setLanguage=function(b){for(var c in b)"object"==typeof b[c]?a.validMessage.hasOwnProperty(c)?Object.assign(a.validMessage[c],b[c]):a.validMessage[c]=Object.assign({},b[c]):a.validMessage[c]=b[c]},b.valid=function(b,c){return a.isElement(b)?"form"===b.nodeName.toLowerCase()?a.validForm(b,c):a.validItem(b,c):void 0},b.verify=function(b,c){c=Object.assign({},a.defaults,c),this.valid(b,c)},b.attach=function(){var c,e,f,g,d={};for(f=0,g=arguments.length;g>f;f++)a.isElement(arguments[f])?c=arguments[f]:"object"==typeof arguments[f]&&(d=Object.assign(d,arguments[f]));return a.isElement(c)&&c.nodeName&&"form"===c.nodeName.toLowerCase()?(e=c.dataset.cxVid,"function"!=typeof a.formFuns[e]?(e="cxValid_"+a.vid,c.dataset.cxVid=e,a.vid++):c.removeEventListener("submit",a.formFuns[e]),a.formFuns[e]=a.formSubmitFn.bind(a,c,d),c.addEventListener("submit",a.formFuns[e]),void 0):(console.warn("[cxValidation] Not form element."),void 0)},b.detach=function(b){var d;a.isElement(b)&&b.nodeName&&"form"===b.nodeName.toLowerCase()&&(d=b.dataset.cxVid,delete b.dataset.cxVid,d&&"function"==typeof a.formFuns[d]&&(b.removeEventListener("submit",a.formFuns[d]),delete a.formFuns[d]))},b});