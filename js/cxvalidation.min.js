/*!
 * cxValidation
 * @name cxvalidation.js
 * @version 0.9.0
 * @date 2021-05-24
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxValidation
 * @license Released under the MIT license
 */
!function(a,b){"use strict";var d,c={defaults:{complete:b,success:b,error:b},result:{status:!0},validMessage:{titleSymbol:{before:"【",after:"】"},required:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},groupRequired:{input:"至少填写 {{1}} 项",radio:"未选择",checkbox:"至少选择 {{1}} 项"},condRequired:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},equals:"两次输入内容不一致",minSize:"最少 {{0}} 个字符",maxSize:"最多 {{0}} 个字符",min:"最小值为 {{0}}",max:"最大值为 {{0}}",integer:"无效的整数",number:"无效的数值",onlyNumber:"只能填写数字",onlyNumberSp:"只能填写数字和空格",onlyLetter:"只能填写英文字母",onlyLetterSp:"只能填写英文字母和空格",onlyLetterNumber:"只能填写英文字母与数字",onlyLetterNumberSp:"只能填写英文字母、数字、空格",email:"无效的邮件地址",phone:"无效的电话号码",url:"无效的网址",chinese:"只能填写中文汉字",chinaId:"无效的身份证号码",chinaIdLoose:"无效的身份证号码",chinaZip:"无效的邮政编码",qq:"无效的 QQ 号码"},isElement:function(a){return a&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&a instanceof HTMLElement?!0:a&&a.nodeType&&1===a.nodeType?!0:!1},isJquery:function(a){return a&&a.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&a instanceof jQuery?!0:!1},isZepto:function(a){return a&&a.length&&("function"==typeof Zepto||"object"==typeof Zepto)&&Zepto.zepto.isZ(a)?!0:!1},isHidden:function(b){if(this.isElement(b)){var c=a.getComputedStyle(b);return"none"===c.getPropertyValue("display")||"hidden"===c.getPropertyValue("visibility")||0==c.getPropertyValue("opacity")||0==c.getPropertyValue("width")&&0==c.getPropertyValue("height")?!0:!1}return!0},isVisible:function(a){return!this.isHidden(a)},isAndroid:/android/i.test(navigator.userAgent)};c.validFun={required:function(a){return"checkbox"===a.type||"radio"===a.type?a.checked?!0:!1:a.value.trim().length?!0:!1},groupRequired:function(a,b,d){return b=String(b),d=parseInt(d,10),isNaN(d)&&(d=1),("undefined"==typeof c.groupCache[b]||"undefined"==typeof c.groupCache[b].count)&&(c.groupCache[b]={count:d}),c.groupCache[b].count>0&&(c.validFun.required(a)?c.groupCache[b].count-=1:"undefined"==typeof c.groupCache[b].element&&(c.groupCache[b].element=a)),!0},condRequired:function(a,b,d){var g,h,e=!1,f=!0;if("string"==typeof b&&b.length){if(b.indexOf(",")>0){if(b=b.split(","),Array.isArray(b)&&b.length)for(e=!0,g=0,h=b.length;h>g;g++)if(!c.validFun.required(document.getElementById(b[g]))){e=!1;break}}else"string"==typeof d?document.getElementById(b).value===d&&(e=!0):c.validFun.required(document.getElementById(b))&&(e=!0);e&&(f=c.validFun.required(a))}return f},equals:function(a,b){return a.value==document.getElementById(b).value},minSize:function(a,b){return a.value.length&&a.value.length>=b},maxSize:function(a,b){return a.value.length&&a.value.length<=b},min:function(a,b){return a.value.length&&parseFloat(a.value)>=b},max:function(a,b){return a.value.length&&parseFloat(a.value)<=b},integer:function(a){return a.value.length&&/^[\-\+]?\d+$/.test(a.value)},number:function(a){return a.value.length&&/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/.test(a.value)},onlyNumber:function(a){return a.value.length&&/^[0-9]+$/.test(a.value)},onlyNumberSp:function(a){return a.value.length&&/^[0-9\ ]+$/.test(a.value)},onlyLetter:function(a){return a.value.length&&/^[a-zA-Z]+$/.test(a.value)},onlyLetterSp:function(a){return a.value.length&&/^[a-zA-Z\ ]+$/.test(a.value)},onlyLetterNumber:function(a){return a.value.length&&/^[0-9a-zA-Z]+$/.test(a.value)},onlyLetterNumberSp:function(a){return a.value.length&&/^[0-9a-zA-Z\ ]+$/.test(a.value)},email:function(a){return a.value.length&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a.value)},phone:function(a){return a.value.length&&/^([\+][0-9]{1,3}[ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/.test(a.value)},url:function(a){return a.value.length&&/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a.value)},chinese:function(a){return a.value.length&&/^[\u4E00-\u9FA5]+$/.test(a.value)},chinaId:function(a){return a.value.length&&/^[1-9]\d{5}[1-9]\d{3}(((0[13578]|1[02])(0[1-9]|[12]\d|3[0-1]))|((0[469]|11)(0[1-9]|[12]\d|30))|(02(0[1-9]|[12]\d)))(\d{4}|\d{3}[xX])$/.test(a.value)},chinaIdLoose:function(a){return a.value.length&&/^(\d{18}|\d{15}|\d{17}[xX])$/.test(a.value)},chinaZip:function(a){return a.value.length&&/^\d{6}$/.test(a.value)},qq:function(a){return a.value.length&&/^[1-9]\d{4,10}$/.test(a.value)},call:function(){var d,e,f,b=Array.prototype.slice.call(arguments),c=b.splice(1,1);if(c.indexOf(".")>=0){for(d=c.split("."),e=a;d.length;)e=e[d.shift()];f=e}else f=a[c];return"function"==typeof f?f.apply(e,b):!0}},c.init=function(){var b=this;b.groupCache={},b.vid=1,b.formFuns={},"object"==typeof a.cxValidationMessage&&$.extend(!0,b.validMessage,a.cxValidationMessage)},c.getRuleArguments=function(a,b){var e,c=a.dataset.validation,d=[],f=[];return"string"==typeof c&&c.length&&(d=c.replace(/\s|\[[^\]]*\]/g,"").split(",")),"string"==typeof b&&b.length&&d.indexOf(b)>=0&&(e=c.match(new RegExp(b+"((\\[[^\\]]+\\])+)")),Array.isArray(e)&&e.length>1&&(f=e[1].match(/([^\[\]]+)/g),Array.isArray(f)&&1===f.length&&"groupRequired"===b&&(f[1]=1))),f},c.getMessage=function(a,b){var e,h,i,c=this,d="",f=a.nodeName.toLowerCase();if("string"==typeof a.dataset.validationMessage&&a.dataset.validationMessage.length)try{d=JSON.parse(a.dataset.validationMessage),"string"==typeof d[b]&&d[b].length&&(d=d[b])}catch(g){d=a.dataset.validationMessage}else("string"==typeof c.validMessage[b]||"object"==typeof c.validMessage[b])&&("string"==typeof c.validMessage[b]?d=c.validMessage[b]:"input"===f?"radio"===a.type&&"string"==typeof c.validMessage[b].radio?d=c.validMessage[b].radio:"checkbox"===a.type&&"string"==typeof c.validMessage[b].checkbox?d=c.validMessage[b].checkbox:"string"==typeof c.validMessage[b].input&&(d=c.validMessage[b].input):"select"===f&&"string"==typeof c.validMessage[b].select?d=c.validMessage[b].select:"string"==typeof c.validMessage[b].input&&(d=c.validMessage[b].input),d.length&&"string"==typeof a.dataset.validationTitle&&a.dataset.validationTitle.length&&(d=c.validMessage.titleSymbol.before+a.dataset.validationTitle+c.validMessage.titleSymbol.after+d));if(d.length)for(e=c.getRuleArguments(a,b),h=0,i=e.length;i>h;h++)d=d.replace(new RegExp("\\{\\{"+h+"\\}\\}"),e[h]);return d},c.validItem=function(a,b,c){var h,i,j,k,l,m,d=this,e=$.extend({},d.result),f=a.dataset.validation,g=[];if("function"==typeof b&&(b={success:b}),b=$.extend({},d.defaults,b),"function"==typeof c&&(b.error=c),"object"==typeof b.validMessage&&$.extend(!0,d.validMessage,b.validMessage),"string"==typeof f&&f.length)for(g=f.replace(/\s|\[[^\]]*\]/g,"").split(","),k=0,l=g.length;l>k;k++)if(j=g[k],"function"==typeof d.validFun[j]&&(h=f.match(new RegExp(j+"((\\[[^\\]]+\\])+)")),i=[a],Array.isArray(h)&&h.length>1&&(i=i.concat(h[1].match(/([^\[\]]+)/g))),m=d.validFun[j].apply(d,i),"boolean"==typeof m?e.status=m:$.isPlainObject(e)&&"boolean"==typeof m.status&&(e=m),e.status===!1)){e.rule=j,"string"==typeof e.message&&e.message.length||(e.message=d.getMessage(a,j));break}return e.element=a,"function"==typeof b.complete&&b.complete(e),e.status===!0&&"function"==typeof b.success?b.success(e):e.status===!1&&"function"==typeof b.error&&b.error(e),"object"===b.type?e:e.status},c.validForm=function(a,b,c){var f,g,d=this,e=$.extend({},d.result);if("function"==typeof b&&(b={success:b}),b=$.extend({},d.defaults,b),"function"==typeof c&&(b.error=c),"object"==typeof b.validMessage&&$.extend(!0,d.validMessage,b.validMessage),d.groupCache={},f=[].concat(Array.prototype.slice.call(a.querySelectorAll("input")),Array.prototype.slice.call(a.querySelectorAll("textarea")),Array.prototype.slice.call(a.querySelectorAll("select"))),$.each(f,function(a,b){var c=d.validItem(b,{type:"object"});return $.isPlainObject(c)&&c.status===!1?(e.element=b,e.status=!1,"string"==typeof c.rule&&c.rule.length&&(e.rule=c.rule),"string"==typeof c.message&&c.message.length&&(e.message=c.message),!1):void 0}),e.status===!0)for(g in d.groupCache)if(d.groupCache[g].count>0){e.status=!1,e.rule="groupRequired",e.element=d.groupCache[g].element,e.message=d.getMessage(e.element,e.rule);break}return d.groupCache={},e.form=a,"function"==typeof b.complete&&b.complete(e),e.status===!0&&"function"==typeof b.success?b.success(e):e.status===!1&&"function"==typeof b.error&&b.error(e),"object"===b.type?e:e.status},c.formSubmitFn=function(a,b){var c,d;event.preventDefault(),c=this,d={type:"object",success:function(){a.submit()},error:function(a){c.isAndroid?c.toMessage(a.element,a.message):"required"===a.rule||"condRequired"===a.rule?c.toFocus(a.element):"string"==typeof a.message&&a.message.length?c.toMessage(a.element,a.message,function(){c.toFocus(a.element)}):c.toFocus(a.element)}},b=$.extend({},d,b),c.validForm(a,b)},c.toMessage=function(a,b,c){"function"==typeof $.cxDialog?$.cxDialog({info:b,ok:"function"==typeof c?c:function(){}}):"function"==typeof c?c():alert(b)},c.toFocus=function(a){var b=this;b.isVisible(a)&&a.focus()},c.init(),d=function(){return d.valid.apply(d,arguments)},d.valid=function(){var a,d,e,f,b={};for(d=0,e=arguments.length;e>d;d++)c.isElement(arguments[d])?a=arguments[d]:c.isJquery(arguments[d])||c.isZepto(arguments[d])?a=arguments[d][0]:"function"==typeof arguments[d]?"function"==typeof b.success?b.error=arguments[d]:b.success=arguments[d]:"object"==typeof arguments[d]&&(b=$.extend(b,arguments[d]));return c.isElement(a)?(f=a.nodeName.toLowerCase(),"input"===f||"select"===f||"textarea"===f?c.validItem(a,b):c.validForm(a,b)):void 0},d.attach=function(b){var f,h,i,j,g={};for(h=0,i=arguments.length;i>h;h++)c.isJquery(arguments[h])||c.isZepto(arguments[h])||c.isElement(arguments[h])?f=c.isJquery(arguments[h])||c.isZepto(arguments[h])?arguments[h][0]:arguments[h]:"function"==typeof arguments[h]?"function"==typeof g.success?g.error=arguments[h]:g.success=arguments[h]:"object"==typeof arguments[h]&&(g=$.extend(g,arguments[h]));return"function"!=typeof g.error&&"function"==typeof a.cxValidationFormErrorCallback&&(g.error=a.cxValidationFormErrorCallback),c.isElement(f)&&f.nodeName&&"form"===f.nodeName.toLowerCase()?(j=f.dataset.cxVid,"function"!=typeof c.formFuns[j]?(j="cxValid_"+c.vid,f.dataset.cxVid=j,c.vid++):b.removeEventListener("submit",c.formFuns[j]),c.formFuns[j]=c.formSubmitFn.bind(c,f,g),f.addEventListener("submit",c.formFuns[j]),!0):!1},d.detach=function(a){if((c.isJquery(a)||c.isZepto(a))&&(a=a[0]),!c.isElement(a)||!a.nodeName||"form"!==a.nodeName.toLowerCase())return!1;var d=a.dataset.cxVid;return"function"!=typeof c.formFuns[d]?!1:(a.removeEventListener("submit",c.formFuns[d]),!0)},$.cxValidation=a.cxValidation=d}(window);