/*!
 * cxValidation
 * @version 1.2.0
 * @author ciaoca
 * @email ciaoca@gmail.com
 * @site https://github.com/ciaoca/cxValidation
 * @license Released under the MIT license
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.cxValidation=t()}("undefined"!=typeof self?self:this,function(){"use strict";function e(){return e.valid.apply(e,arguments)}const n={validMessage:{titleSymbol:{before:"【",after:"】"},required:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},groupRequired:{input:"至少填写 {{1}} 项",radio:"未选择",checkbox:"至少选择 {{1}} 项"},condRequired:{input:"未填写",radio:"未选择",checkbox:"未勾选",select:"未选择"},equals:"两次输入内容不一致",minSize:"最少 {{0}} 个字符",maxSize:"最多 {{0}} 个字符",min:"最小值为 {{0}}",max:"最大值为 {{0}}",integer:"无效的整数",number:"无效的数值",onlyNumber:"只能填写数字",onlyNumberSp:"只能填写数字和空格",onlyLetter:"只能填写英文字母",onlyLetterSp:"只能填写英文字母和空格",onlyLetterNumber:"只能填写英文字母与数字",onlyLetterNumberSp:"只能填写英文字母、数字、空格",email:"无效的邮件地址",phone:"无效的电话号码",url:"无效的网址",chinese:"只能填写中文汉字",chinaId:"无效的身份证号码",chinaIdLoose:"无效的身份证号码",chinaZip:"无效的邮政编码",qq:"无效的 QQ 号码"},result:{status:!0},vid:1,formFuns:{},groupCache:{},isElement:function(e){return!(!e||"function"!=typeof HTMLElement&&"object"!=typeof HTMLElement||!(e instanceof HTMLElement))||!(!e||!e.nodeType||1!==e.nodeType)},isHidden:function(e){if(this.isElement(e)){const t=window.getComputedStyle(e);return"none"===t.getPropertyValue("display")||"hidden"===t.getPropertyValue("visibility")||0==t.getPropertyValue("opacity")||0==t.getPropertyValue("width")&&0==t.getPropertyValue("height")}return!0},isVisible:function(e){return!this.isHidden(e)},init:function(){const u=this;u.defaults={success:e=>{e.form.submit()},error:e=>{var t=e.element.nodeName.toLowerCase();"required"!==e.rule&&"condRequired"!==e.rule||"input"===t&&0<=["radio","checkbox","color","range","file","hidden"].indexOf(e.element.type)?u.toMessage(e.message):u.toFocus(e.element)}}},validFun:{required:function(e){return"checkbox"===e.type||"radio"===e.type?!!e.checked:!!e.value.trim().length},groupRequired:function(e,t,u){var n=this;return t=String(t),u=parseInt(u,10),isNaN(u)&&(u=1),void 0!==n.groupCache[t]&&void 0!==n.groupCache[t].count||(n.groupCache[t]={count:u}),0<n.groupCache[t].count&&(n.validFun.required(e)?--n.groupCache[t].count:void 0===n.groupCache[t].element&&(n.groupCache[t].element=e)),!0},condRequired:function(e,t,u){var n=this;let a=!1,i=!0;if("string"==typeof t&&t.length){if(0<t.indexOf(",")){if(t=t.split(","),Array.isArray(t)&&t.length){a=!0;for(var r of t)if(!n.validFun.required(document.getElementById(r))){a=!1;break}}}else"string"==typeof u?document.getElementById(t).value===u&&(a=!0):n.validFun.required(document.getElementById(t))&&(a=!0);a&&(i=n.validFun.required(e))}return i},equals:function(e,t){return e.value==document.getElementById(t).value},minSize:function(e,t){return!e.value.length||e.value.length>=t},maxSize:function(e,t){return!e.value.length||e.value.length<=t},min:function(e,t){return!e.value.length||parseFloat(e.value)>=t},max:function(e,t){return!e.value.length||parseFloat(e.value)<=t},integer:function(e){return!e.value.length||/^[\-\+]?\d+$/.test(e.value)},number:function(e){return!e.value.length||/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/.test(e.value)},onlyNumber:function(e){return!e.value.length||/^[0-9]+$/.test(e.value)},onlyNumberSp:function(e){return!e.value.length||/^[0-9\ ]+$/.test(e.value)},onlyLetter:function(e){return!e.value.length||/^[a-zA-Z]+$/.test(e.value)},onlyLetterSp:function(e){return!e.value.length||/^[a-zA-Z\ ]+$/.test(e.value)},onlyLetterNumber:function(e){return!e.value.length||/^[0-9a-zA-Z]+$/.test(e.value)},onlyLetterNumberSp:function(e){return!e.value.length||/^[0-9a-zA-Z\ ]+$/.test(e.value)},email:function(e){return!e.value.length||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e.value)},phone:function(e){return!e.value.length||/^([\+][0-9]{1,3}[ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/.test(e.value)},url:function(e){return!e.value.length||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e.value)},chinese:function(e){return!e.value.length||/^[\u4E00-\u9FA5]+$/.test(e.value)},chinaId:function(e){return!e.value.length||/^[1-9]\d{5}[1-9]\d{3}(((0[13578]|1[02])(0[1-9]|[12]\d|3[0-1]))|((0[469]|11)(0[1-9]|[12]\d|30))|(02(0[1-9]|[12]\d)))(\d{4}|\d{3}[xX])$/.test(e.value)},chinaIdLoose:function(e){return!e.value.length||/^(\d{18}|\d{15}|\d{17}[xX])$/.test(e.value)},chinaZip:function(e){return!e.value.length||/^\d{6}$/.test(e.value)},qq:function(e){return!e.value.length||/^[1-9]\d{4,10}$/.test(e.value)},call:function(){const e=Array.prototype.slice.call(arguments);let t=e.splice(1,1),u=window;if(0<=t.indexOf("."))for(t=t.split(".");t.length;)u=u[t.shift()];else u=u[t];return"function"!=typeof u||u.apply(u,e)}},getRuleArguments:function(e,t){const u=e.dataset.validation;let n=[],a=[];if("string"==typeof u&&u.length&&(n=u.replace(/\s|\[[^\]]*\]/g,"").split(",")),"string"==typeof t&&t.length&&0<=n.indexOf(t)){let e=u.match(new RegExp(t+"((\\[[^\\]]+\\])+)"));Array.isArray(e)&&1<e.length&&(a=e[1].match(/([^\[\]]+)/g),Array.isArray(a)&&1===a.length&&"groupRequired"===t&&(a[1]=1))}return a},getMessage:function(t,e){var u=this,n=t.nodeName.toLowerCase();let a="";if("string"==typeof t.dataset.validationMessage&&t.dataset.validationMessage.length)try{"string"==typeof(a=JSON.parse(t.dataset.validationMessage))[e]&&a[e].length&&(a=a[e])}catch(e){a=t.dataset.validationMessage}else"string"!=typeof u.validMessage[e]&&"object"!=typeof u.validMessage[e]||("string"==typeof u.validMessage[e]?a=u.validMessage[e]:"input"===n?"radio"===t.type&&"string"==typeof u.validMessage[e].radio?a=u.validMessage[e].radio:"checkbox"===t.type&&"string"==typeof u.validMessage[e].checkbox?a=u.validMessage[e].checkbox:"string"==typeof u.validMessage[e].input&&(a=u.validMessage[e].input):"select"===n&&"string"==typeof u.validMessage[e].select?a=u.validMessage[e].select:"string"==typeof u.validMessage[e].input&&(a=u.validMessage[e].input),a.length&&"string"==typeof t.dataset.validationTitle&&t.dataset.validationTitle.length&&(a=u.validMessage.titleSymbol.before+t.dataset.validationTitle+u.validMessage.titleSymbol.after+a));if(a.length)for(var i=u.getRuleArguments(t,e),r=0,s=i.length;r<s;r++)a=a.replace(new RegExp("\\{\\{"+r+"\\}\\}"),i[r]);return a},validItem:function(u,e){var n,a=this;let i=Object.assign({},a.result);const r=u.dataset.validation;if(e=Object.assign({},e),"string"==typeof r&&r.length)for(n of r.replace(/\s|\[[^\]]*\]/g,"").split(","))if("function"==typeof a.validFun[n]){let e=r.match(new RegExp(n+"((\\[[^\\]]+\\])+)")),t=[u];if(Array.isArray(e)&&1<e.length&&(t=t.concat(e[1].match(/([^\[\]]+)/g))),"object"==typeof(i="boolean"==typeof(i=a.validFun[n].apply(a,t))?{status:i}:i)&&"boolean"==typeof i.status&&!1===i.status){i.rule=n,"string"==typeof i.message&&i.message.length||(i.message=a.getMessage(u,n));break}}return i.element=u,"function"==typeof e.complete&&e.complete(i),!0===i.status&&"function"==typeof e.success?e.success(i):!1===i.status&&"function"==typeof e.error&&e.error(i),i},validForm:function(e,t){var u=this;const n=Object.assign({},u.result);var a,i=e.querySelectorAll("input,textarea,select");t=Object.assign({},t),u.groupCache={};for(a of i){var r=u.validItem(a);if(r&&!1===r.status){n.status=!1,n.element=a,"string"==typeof r.rule&&r.rule.length&&(n.rule=r.rule),"string"==typeof r.message&&r.message.length&&(n.message=r.message);break}}if(n&&!0===n.status)for(var s in u.groupCache)if(0<u.groupCache[s].count){n.status=!1,n.rule="groupRequired",n.element=u.groupCache[s].element,n.message=u.getMessage(n.element,n.rule);break}return n.form=e,u.groupCache={},"function"==typeof t.complete&&t.complete(n),!0===n.status&&"function"==typeof t.success?t.success(n):!1===n.status&&"function"==typeof t.error&&t.error(n),n},formSubmitFn:function(e,t){event.preventDefault(),this.validForm(e,Object.assign({},this.defaults,t))},toMessage:function(e){alert(e)},toFocus:function(e){this.isVisible(e)&&e.focus()}};n.init();return e.setOptions=function(e){Object.assign(n.defaults,e)},e.setLanguage=function(e){for(var t in e)"object"==typeof e[t]?n.validMessage.hasOwnProperty(t)?Object.assign(n.validMessage[t],e[t]):n.validMessage[t]=Object.assign({},e[t]):n.validMessage[t]=e[t]},e.valid=function(e,t){if(n.isElement(e))return"form"===e.nodeName.toLowerCase()?n.validForm(e,t):n.validItem(e,t)},e.verify=function(e,t){this.valid(e,Object.assign({},n.defaults,t))},e.attach=function(){let t;var e,u={};for(e of arguments)n.isElement(e)?t=e:"object"==typeof e&&Object.assign(u,e);if(n.isElement(t)&&t.nodeName&&"form"===t.nodeName.toLowerCase()){let e=t.dataset.cxVid;"function"!=typeof n.formFuns[e]?(e="cxValid_"+n.vid,t.dataset.cxVid=e,n.vid++):t.removeEventListener("submit",n.formFuns[e]),n.formFuns[e]=n.formSubmitFn.bind(n,t,u),t.addEventListener("submit",n.formFuns[e])}else console.warn("[cxValidation] Not form element.")},e.detach=function(e){var t;n.isElement(e)&&e.nodeName&&"form"===e.nodeName.toLowerCase()&&(t=e.dataset.cxVid,delete e.dataset.cxVid,t&&"function"==typeof n.formFuns[t]&&(e.removeEventListener("submit",n.formFuns[t]),delete n.formFuns[t]))},e});